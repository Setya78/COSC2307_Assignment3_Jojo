-- SECTION C: QUERY 
-- Author: Jojo
-- Course: COSC2307 - Database Programming
-- Assignment 3

-- Use DB
USE manufacturing_db;

-- =====================
-- QUERY 1: “List Operators and Their Current Job Assignments”
-- =====================

SELECT 
o.OperatorID, 
o.OperatorName,
jo.JobOrderID,
jo.Status
FROM Operators o
LEFT JOIN JobOrders jo
ON o.OperatorID = jo.OperatorID;


-- =====================
-- QUERY 2: “List All Projects and Their Client Names with Upcoming Deadlines”
-- =====================
-- Note: the result empty Because there are no projects with deadlines after Nov 15, 2025

SELECT 
p.ProjectID, 
p.ClientID,
c.CompanyName,
p.ProjectDeadline
FROM Projects p
LEFT JOIN Clients c
ON p.ClientID = c.ClientID
WHERE p.ProjectDeadline >= CURDATE()
ORDER BY p.ProjectDeadline ASC;

-- =====================
-- QUERY 3: “Get the Number of Completed Job Orders for Each Machine”
-- =====================
SELECT 
m.MachineID, 
m.MachineName,
COUNT(jo.JobOrderID) AS CompletedJobOrders
FROM Machines m
LEFT JOIN JobOrders jo
ON m.MachineID = jo.MachineID 
AND jo.Status = 'Completed'
GROUP BY m.MachineID, m.MachineName
ORDER BY CompletedJobOrders DESC, m.MachineID ASC;
